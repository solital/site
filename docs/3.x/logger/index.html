<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Logger - Solital Framework</title>
  <link rel="shortcut icon" href="../img/favicon.ico">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/styles/default.css">
  <link rel="stylesheet" href="../css/styles/atom-one-dark.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

  

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/bootstrap.bundle.min.js"></script>
  <script src="../js/highlight.pack.js"></script>
  <script src="../js/scripts.js"></script>
  <script>hljs.highlightAll();</script>

  
  

  
    <script src="../search/main.js"></script>
  

  

</head>

<body>
  <div class="dashboard">
    <div class="dashboard-nav">
      <header class="mb-4">
        <a href="#!" class="menu-toggle">
          <i class="fas fa-bars"></i>
        </a>

        <a href="https://solital.github.io/site/" class="brand-logo">
          <img src="../img/solital-logo-2-sm-trans-2.png" alt="Solital Framework">
        </a>
      </header>

      <nav class="dashboard-nav-list">
        
        
  <a href=".." class="dashboard-nav-item ">
    Starting
  </a>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Upgrade
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="https://github.com/solital/core/releases" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Release Notes
      </a>
    
      <a href="../upgrade-guide/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Upgrade Guide
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Settings
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../installation/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Installing
      </a>
    
      <a href="../environment-variables/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Environment Variables
      </a>
    
      <a href="../yaml-files/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> YAML Files
      </a>
    
      <a href="../helpers/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Helpers
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Routers
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../routes/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Routes
      </a>
    
      <a href="../middleware/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Middleware
      </a>
    
      <a href="../url/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> URL
      </a>
    
      <a href="../events/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Events
      </a>
    
      <a href="../input-and-params/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Input and params
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Components
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../vinci-console/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Vinci Console
      </a>
    
      <a href="../cache/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cache
      </a>
    
      <a href="../dependency-container/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dependency Container
      </a>
    
      <a href="../event-loop/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Event Loop
      </a>
    
      <a href="../http-client/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> HTTP Client
      </a>
    
      <a href="../wolf-template/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Wolf Template
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle active ">
    Resources
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../date-and-time/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Date and time
      </a>
    
      <a href="../file-system/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> File System
      </a>
    
      <a href="../json/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> JSON
      </a>
    
      <a href="./" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Logger
      </a>
    
      <a href="../mailer-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mailer
      </a>
    
      <a href="../session-and-cookie/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Session and Cookie
      </a>
    
      <a href="../validation-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Validation
      </a>
    
      <a href="../messages/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Messages
      </a>
    
      <a href="../queue/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Queue
      </a>
    
      <a href="../collection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Collection
      </a>
    
      <a href="../string-manipulate/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Strings
      </a>
    
      <a href="../mask/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mask
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Security
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../authenticate/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Authenticate
      </a>
    
      <a href="../cryptography/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cryptography
      </a>
    
      <a href="../csrf-protection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> CSRF Protection
      </a>
    
      <a href="../secure-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Secure Password
      </a>
    
      <a href="../verify-domain/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Verify Domain
      </a>
    
      <a href="../recovery-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Recovery Password
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Database
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../migrations/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Migrations
      </a>
    
      <a href="../seeders/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Seeders
      </a>
    
      <a href="../dump/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dump
      </a>
    
      <a href="../katrina-orm/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Katrina ORM
      </a>
    
  </div>
</div>

        
        
  <a href="../deploy/" class="dashboard-nav-item ">
    Deploy
  </a>

        
      </nav>
    </div>

    <div class="dashboard-app">
      <header class="dashboard-toolbar">
        <a href="#!" class="menu-toggle btn-menu"><i class="fas fa-bars"></i></a>
      </header>

      <div class="dashboard-content">
        <div class="container">

          <section class="container section">
            <div class="row">
              <div class="col-md-12 col-sm-12 w-100">
                <h1 class="mt-4 font-weight-normal title-page">Logger</h1>
              </div>

              <div class="col-md-12 col-sm-12 mt-3">
                

                <ul class="ml-5 mb-5">
                  
                    <li><a href="#usage">Usage</a></li>
                  
                  
                    <li><a href="#concepts">Concepts</a></li>
                  
                  
                    <li><a href="#apis">APIs</a></li>
                  
                  
                    <li><a href="#auto-log">Auto log</a></li>
                  
                  
                </ul>

                
                <p>First, every Logger has a <code>channel</code>, which is a name that will be associated with each entry of the logger log, and each part of the application can have a logger with a different channel to better differentiate them, facilitating the filtering of information,</p>
<p>To the Logger must be added one or more <code>handlers</code> that are components that record the logs in certain ways, like the classic files or sockets and databases for example.</p>
<p>Another important concept in the use of logs is the level of the log record, not all information has the same “importance” in the log, or the same urgency to be dealt with, so entries in a log are categorized by levels:</p>
<ul>
<li><strong>DEBUG:</strong> Debug information.</li>
<li><strong>INFO:</strong> Interesting events. For example: a user performed SQL login or logs.</li>
<li><strong>NOTICE:</strong> Normal but significant events.</li>
<li><strong>WARNING:</strong> Exceptional occurrences, but not errors. For example: Use of deprecated APIs, inappropriate use of an API. In general things that are not wrong but need attention.</li>
<li><strong>ERROR:</strong> Runtime errors that do not require immediate action, but must be logged and monitored.</li>
<li><strong>CRITICAL:</strong> Critical conditions. For example: An application component is not available, an unexpected exception has occurred.</li>
<li><strong>ALERT:</strong> Immediate action must be taken. Example: System crashed, database is unavailable, etc. It should trigger an alert for the person in charge to take action as soon as possible.</li>
<li><strong>EMERGENCY:</strong> Emergency: The system is unusable.</li>
</ul>
<h2 id="usage">Usage</h2>
<p>Create the logger instance with a channel id,</p>
<pre><code class="language-php">use Psr\Log\LogLevel;
use Solital\Core\Logger\Logger;
use Solital\Core\Logger\Entry\MemoryInfo;
use Solital\Core\Logger\Handler\SyslogHandler;
use Solital\Core\Logger\Handler\TerminalHandler;

// with channel id
$logger = new Logger('MyApp');

// log every warning to syslog
$logger-&gt;addHandler(
    LogLevel::WARNING,
    new SyslogHandler()
);

// log to terminal for MemoryInfo entry
$logger-&gt;addHandler(
    LogLevel::INFO,
    new TerminalHandler(),
    MemoryInfo::class // handle this log object only
);

// log a text message
$logger-&gt;warning('a warning message');

// log memory usage
$logger-&gt;info(new MemoryInfo());
</code></pre>
<p>If you are using a Controller, you don't need to instantiate the <code>Logger</code> class. Just use <code>$this-&gt;logger()</code> method:</p>
<pre><code class="language-php">$this-&gt;logger('MyApp')-&gt;addHandler(
        LogLevel::WARNING,
        new SyslogHandler()
    )-&gt;warning('a warning message');
</code></pre>
<h2 id="concepts">Concepts</h2>
<ul>
<li><strong>Log entry</strong></li>
</ul>
<p><em>A log entry</em> is a message in the form of an object. It solves the problem
of <strong>'WHAT TO BE SENT OUT'</strong>. It has a message template, and some processors
to process its context.</p>
<p>For example, <code>Entry\MemoryInfo</code> is a predefined log entry with a message
template of <code>{memory_used}M memory used , peak usage is {memory_peak}M</code>
and one <code>Processor\MemoryProcessor</code> processor.</p>
<pre><code class="language-php">// with predefined template and processor
$logger-&gt;warning(new MemoryInfo());

// use new template
$logger-&gt;warning(new MemoryInfo('Peak memory usage is {memory_peak}M'));
</code></pre>
<p><code>Entry\LogEntry</code> is the log entry prototype used whenever text message is
to be logged</p>
<pre><code class="language-php">// using LogEntry
$logger-&gt;info('test only');
</code></pre>
<p>To define your own log entry,</p>
<pre><code class="language-php">use Solital\Core\Logger\Entry\LogEntry;

class MyMessage extends LogEntry
{
    // message template
    protected $message = 'your {template}';
}

// add handler
$logger-&gt;addHandler(
    'warning', // level
    function(LogEntry $entry) { // a handler
        echo (string) $entry;
    },
    MyMessage::class // handle this type of message only
);

// output: 'your wow'
$logger-&gt;error(new MyMessage(), ['template' =&gt; 'wow']);
</code></pre>
<ul>
<li><strong>Processor</strong></li>
</ul>
<p><em>Processors</em> are associated with log entry classes. They solve the problem of
<strong>'WHAT EXTRA INFO TO SENT OUT'</strong>. They will inject information into entries'
context. Processors are <code>callable(LogEntryInterface $entry)</code>,</p>
<pre><code class="language-php">use Solital\Core\Logger\Processor\ProcessorAbstract;

// closure
$processor1 = function(LogEntry $entry) {
};

// invokable object
$processor2 = new class() {
    public function __invoke(LogEntry $entry)
    {
    }
}

// extends
class Processor3 extends ProcessorAbstract
{
    protected function updateContext(array $context): array
    {
        $context['bingo'] = 'wow';
        return $context;
    }
} 
</code></pre>
<p>Processors are attached to log entries either in the entry class definition
as follows,</p>
<pre><code class="language-php">class MyMessage extends LogEntry
{
    // message template
    protected $message = 'your {template}';

    // define processors for this class
    protected static function classProcessors(): array
    {
        return [
            function(LogEntry $entry) {
                $context = $entry-&gt;getContext();
                $context['template'] = 'wow';
                $entry-&gt;setContext($context);
            },
            new myProcessor(),
        ];
    }
}
</code></pre>
<p>or during the handler attachment</p>
<pre><code class="language-php">use Solital\Core\Logger\Handler\SyslogHandler;

// will also add 'Processor1' and 'Processor2' to 'MyMessage' class
$logger-&gt;addHandler(
    'info',
    new SyslogHandler(),
    MyMessage::addProcessor(
        new Processor1(),
        new Processor2(),
        ...
    )
);
</code></pre>
<ul>
<li><strong>Handler</strong></li>
</ul>
<p><em>Handlers</em> solve the problem of <strong>'WHERE TO SEND MESSAGE'</strong>. They take a
log entry object and send it to somewhere.</p>
<p>Handlers takes the form of <code>callable(LogEntryInterface $entry)</code> as follows,</p>
<pre><code class="language-php">use Solital\Core\Logger\Handler\HandlerAbstract;

$handler1 = function(LogEntry $entry) {
    echo (string) $entry;
}

$handler2 = new class() {
    public function __invoke(LogEntry $entry)
    {
    }
}

class Handler3 extends HandlerAbstract
{
    protected function write(LogEntryInterface $entry)
    {
        echo $this-&gt;&gt;getFormatter()-&gt;format($entry);
    }
}
</code></pre>
<p>Handlers are added to the <code>$logger</code> with specific log level and type of
log message they are going to handle (default is <code>LogEntryInterface</code>).</p>
<pre><code class="language-php">$logger-&gt;addHandler(
    LogLevel::WARNING,
    new TerminalHandler(),
    LogEntryInterface::class // this is the default anyway
);
</code></pre>
<ul>
<li><strong>Formatter</strong></li>
</ul>
<p><em>Formatters</em> solve the problem of <strong>'HOW MESSAGE WILL BE PRESENTED''</strong>.
Each handler of the type <code>Handler\HandlerAbstract</code> may have formatter
specified during its initiation.</p>
<pre><code class="language-php">use Solital\Core\Logger\Handler\TerminalHandler;
use Solital\Core\Logger\Formatter\AnsiFormatter;

// use ANSI Color formatter
$handler = new TerminalHandler(new AnsiFormatter());

// add handler handles 'ConsoleMessage' ONLY
$logger-&gt;addHandler('debug', $handler, ConsoleMessage::class);

// log to console
$logger-&gt;info(new ConsoleMessage('exited with error.'));

// this will goes handlers handling 'LogEntry'
$logger-&gt;info('exited with error');
</code></pre>
<h2 id="apis">APIs</h2>
<ul>
<li><code>LoggerInterface</code> related</li>
</ul>
<p>See [PSR-3][PSR-3] for standard related APIs.</p>
<ul>
<li>
<p><code>Solital\Core\Logger\Logger</code> related</p>
</li>
<li>
<p><code>__construct(string $channel)</code></p>
</li>
</ul>
<p>Create the logger with a channel id.</p>
<ul>
<li><code>addHandler(string $level, callable $handler, string $entryClass, int $priority = 50): $this</code></li>
</ul>
<p>Add one handler to specified channel with the priority.</p>
<ul>
<li>
<p><code>Solital\Core\Logger\Entry\LogEntry</code> related</p>
</li>
<li>
<p><code>static function addProcessor(callable ...$callables): string</code></p>
</li>
</ul>
<p>This method will returns called class name.</p>
<h2 id="auto-log">Auto log</h2>
<p>Solital generates a log file whenever a critical system error occurs. Log files are stored in <code>app/Storage/log/</code>.</p>
<p>To disable the creation of these files, open the <code>bootstrap.yaml</code> file and change the <code>enabled_log_files</code> key to <code>false</code>:</p>
<pre><code class="language-yaml">logs:
  enabled_log_files: false
</code></pre>
                

                <hr />

                
                <h3>What to see next?</h3>

                <section aria-label="breadcrumb" class="mt-4">
                  <ol class="breadcrumb">
                    
                      <li class="breadcrumb-item"><a href="../json/">&#8592; JSON</a></li>
                    
                    
                      <li class="breadcrumb-item"><a href="../mailer-component/">Mailer &#8594;</a></li>
                    
                  </ol>
                </section>
                

              </div>

              <hr>

              <div class="row text-center mt-3">
                <div class="col-md-12 col-sm-12 ml-2">
                  Built with <a href="https://www.mkdocs.org">MkDocs</a>.
                </div>
              </div>
            </div>

            <!--
              MkDocs version      : 1.5.3
              Docs Build Date UTC : 2023-11-25 00:18:51.128554+00:00
              -->

          </section>
        </div>
      </div>
    </div>
  </div>
</body>

</html>