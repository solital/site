<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cache - Solital Framework</title>
  <link rel="shortcut icon" href="../img/favicon.ico">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/styles/default.css">
  <link rel="stylesheet" href="../css/styles/atom-one-dark.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

  

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/bootstrap.bundle.min.js"></script>
  <script src="../js/highlight.pack.js"></script>
  <script src="../js/scripts.js"></script>
  <script>hljs.highlightAll();</script>

  
  

  
    <script src="../search/main.js"></script>
  

  

</head>

<body>
  <div class="dashboard">
    <div class="dashboard-nav">
      <header class="mb-4">
        <a href="#!" class="menu-toggle">
          <i class="fas fa-bars"></i>
        </a>

        <a href="#" class="brand-logo">
          <img src="../img/solital-logo-2-sm-trans-2.png" alt="Solital Framework">
        </a>
      </header>

      <nav class="dashboard-nav-list">
        
        
  <a href=".." class="dashboard-nav-item ">
    Starting
  </a>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Upgrade
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="https://github.com/solital/core/releases" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Release Notes
      </a>
    
      <a href="../upgrade-guide/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Upgrade Guide
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Settings
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../installation/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Installing
      </a>
    
      <a href="../environment-variables/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Environment Variables
      </a>
    
      <a href="../yaml-files/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> YAML Files
      </a>
    
      <a href="../helpers/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Helpers
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Routers
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../routes/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Routes
      </a>
    
      <a href="../middleware/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Middleware
      </a>
    
      <a href="../url/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> URL
      </a>
    
      <a href="../events/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Events
      </a>
    
      <a href="../input-and-params/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Input and params
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle active ">
    Components
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../vinci-console/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Vinci Console
      </a>
    
      <a href="./" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cache
      </a>
    
      <a href="../dependency-container/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dependency Container
      </a>
    
      <a href="../event-loop/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Event Loop
      </a>
    
      <a href="../http-client/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> HTTP Client
      </a>
    
      <a href="../wolf-template/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Wolf Template
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Resources
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../date-and-time/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Date and time
      </a>
    
      <a href="../file-system/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> File System
      </a>
    
      <a href="../json/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> JSON
      </a>
    
      <a href="../logger/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Logger
      </a>
    
      <a href="../mailer-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mailer
      </a>
    
      <a href="../session-and-cookie/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Session and Cookie
      </a>
    
      <a href="../validation-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Validation
      </a>
    
      <a href="../messages/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Messages
      </a>
    
      <a href="../queue/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Queue
      </a>
    
      <a href="../collection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Collection
      </a>
    
      <a href="../string-manipulate/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Strings
      </a>
    
      <a href="../mask/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mask
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Security
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../authenticate/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Authenticate
      </a>
    
      <a href="../cryptography/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cryptography
      </a>
    
      <a href="../csrf-protection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> CSRF Protection
      </a>
    
      <a href="../secure-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Secure Password
      </a>
    
      <a href="../verify-domain/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Verify Domain
      </a>
    
      <a href="../recovery-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Recovery Password
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Database
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../migrations/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Migrations
      </a>
    
      <a href="../seeders/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Seeders
      </a>
    
      <a href="../dump/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dump
      </a>
    
      <a href="../katrina-orm/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Katrina ORM
      </a>
    
  </div>
</div>

        
        
  <a href="../deploy/" class="dashboard-nav-item ">
    Deploy
  </a>

        
      </nav>
    </div>

    <div class="dashboard-app">
      <header class="dashboard-toolbar">
        <a href="#!" class="menu-toggle btn-menu"><i class="fas fa-bars"></i></a>
      </header>

      <div class="dashboard-content">
        <div class="container">

          <section class="container-fluid section">
            <div class="row">
              <div class="col-md-12 w-100">
                <h1 class="mt-4 font-weight-normal title-page">Cache</h1>
              </div>

              <div class="col-md-12 mt-3">
                

                <ul class="ml-5 mb-5">
                  
                    <li><a href="#how-to-use-psr6psr-16">How to use - PSR6/PSR-16</a></li>
                  
                    <li><a href="#clear-cache">Clear cache</a></li>
                  
                  
                    <li><a href="#http-cache">HTTP Cache</a></li>
                  
                    <li><a href="#cache-control">Cache-Control</a></li>
                  
                    <li><a href="#expires">Expires</a></li>
                  
                    <li><a href="#time-based">Time-based</a></li>
                  
                    <li><a href="#etag">Etag</a></li>
                  
                    <li><a href="#cache-prevention">Cache prevention</a></li>
                  
                  
                    <li><a href="#clear-solital-cache">Clear Solital Cache</a></li>
                  
                  
                </ul>

                
                <p>Cache is a layer of high-speed physical data storage that holds a subset of data, usually temporary in nature, so that future requests for that data are answered more quickly than is possible when accessing the primary storage location of data. Caching allows you to efficiently reuse previously recovered or computed data.</p>
<h2 id="how-to-use-psr6psr-16">How to use - PSR6/PSR-16</h2>
<p><strong>PSR-6</strong></p>
<p>To use the PSR-6, you can follow the step by step guide <a href="http://www.php-fig.org/psr/psr-6/">here</a></p>
<pre><code class="language-php">use Solital\Core\Cache\Psr6\CachePool;

$pool = new CachePool();
$item = $pool-&gt;getItem('aaa');
$item-&gt;set(123);
$pool-&gt;commit();
</code></pre>
<p><strong>PSR-16</strong></p>
<p>You can cache through PSR-16. To do this, perform the instance of the Cache class as follows:</p>
<pre><code class="language-php">use Solital\Cache\SimpleCache;

$cache = new SimpleCache();

$list = User::select()-&gt;get();

// The 'has' method checks whether the index exists
if ($cache-&gt;has('list') == true) {
    echo '&lt;h1&gt;from cache&lt;/h1&gt;';
    // The 'get' method returns the cached value if it exists
    $cache-&gt;get('list');
} else {
    echo '&lt;h1&gt;created cache&lt;/h1&gt;';
    // The 'set' method creates the cached file
    $cache-&gt;set('list', $list, 20);
}

// Displays the original content of the $list variable
echo '&lt;h1&gt;from original&lt;/h1&gt;';
var_dump($list);
</code></pre>
<p>To delete the cache that was created, use the <code>delete</code> method passing the cache key as a parameter.</p>
<pre><code class="language-php">$cache-&gt;delete('list');
</code></pre>
<p>The <code>has</code> method checks whether the item key exists. If it exists, use the <code>get</code> method to retrieve the generated cache by passing the key value as a parameter. If it does not exist, the <code>set</code> method creates the cached file, passing in the first parameter the name of the key, the value that will be stored and the time (in <code>int</code>) that this cached file will be valid.</p>
<p>The syntax is similar to the single cache. But the <code>getMultiple</code> method needs an array containing the key values as a parameter. The <code>setMultiple</code> method generates the cache if it does not exist, but pass as an parameter an array in which the keys will be the indexes of the array, and in the last parameter spend the time that the cache will be valid.</p>
<pre><code class="language-php">use Solital\Cache\SimpleCache;

$cache = new SimpleCache();

$list = [
    'nome' =&gt; 'Harvey Specter',
    'email' =&gt; 'specter@pearsonhardman.com'
];

$list2 = [
    'nome' =&gt; 'Louis Litt',
    'email' =&gt; 'liitup@pearsonhardman.com'
];

$cache-&gt;getMultiple(['list1', 'list2']);

echo '&lt;h1&gt;created cache&lt;/h1&gt;';
$cache-&gt;setMultiple([
    'list1' =&gt; $list,
    'list2' =&gt; $list2
], 20);

echo '&lt;h1&gt;from original&lt;/h1&gt;';
print_r($list);
print_r($list2);
</code></pre>
<p>In the multiple cache, use <code>deleteMultiple</code> by passing an array containing the cache keys to delete the cached files generated with the <code>setMultiple</code> method.</p>
<pre><code class="language-php">$cache-&gt;deleteMultiple([&quot;list1&quot;, &quot;list2&quot;]);
</code></pre>
<h3 id="clear-cache">Clear cache</h3>
<p>To clear the entire cache created with the <code>Cache</code> class, use the <code>clear</code> function.</p>
<pre><code class="language-php">$cache-&gt;clear();
</code></pre>
<h2 id="http-cache">HTTP Cache</h2>
<p>Font by <a href="" title="https://devcenter.heroku.com/articles/increasing-application-performance-with-http-cache-headers">heroku</a></p>
<p>The modern day developer has a wide variety of techniques and technologies available to improve application performance and end-user experience. One of the most frequently overlooked technologies is that of the HTTP cache.</p>
<p>HTTP caching is a universally adopted specification across all modern web browsers, making its implementation in web applications simple. Appropriate use of these standards can benefit your application greatly, improving response times and reducing server load. However, incorrect caching can cause users to see out-of-date content and hard to debug issues. This article discusses the specifics of HTTP caching and in what scenarios to employ an HTTP cache header based strategy.</p>
<pre><code class="language-php">use Solital\Core\Http\HttpCache;

$cache = new HttpCache();
</code></pre>
<h3 id="cache-control">Cache-Control</h3>
<p>The Cache-Control header is the most important header to set as it effectively ‘switches on’ caching in the browser. With this header in place, and set with a value that enables caching, the browser will cache the file for as long as specified. Without this header the browser will re-request the file on each subsequent request.</p>
<p><code>public</code> resources can be cached not only by the end-user’s browser but also by any intermediate proxies that may be serving many other users as well.</p>
<p><code>private</code> resources are bypassed by intermediate proxies and can only be cached by the end-client.</p>
<p>The value of the Cache-Control header is a composite one, indicating whether the resource is public or private while also indicating the maximum amount of time it can be cached before considered stale. The max-age value sets a timespan for how long to cache the resource (in seconds).</p>
<p>In the first parameter it is necessary to inform <code>public</code> or <code>private</code>, and in the second parameter the timestamp value of <code>max_age</code>. </p>
<pre><code class="language-php">$cache-&gt;cacheControl(&quot;public&quot;, 31536000);
</code></pre>
<p>While the Cache-Control header turns on client-side caching and sets the max-age of a resource the Expires header is used to specify a specific point in time the resource is no longer valid.</p>
<h3 id="expires">Expires</h3>
<p>When accompanying the Cache-Control header, Expires simply sets a date from which the cached resource should no longer be considered valid. From this date forward the browser will request a fresh copy of the resource. Until then, the browsers local cached copy will be used:</p>
<pre><code class="language-php">$cache-&gt;cacheControl(&quot;public&quot;, 31536000);
$cache-&gt;expires();
</code></pre>
<h3 id="time-based">Time-based</h3>
<p>A time-based conditional request ensures that only if the requested resource has changed since the browser’s copy was cached will the contents be transferred. If the cached copy is the most up-to-date then the server returns the <code>304</code> response code.</p>
<p>To enable conditional requests the application specifies the last modified time of a resource via the Last-Modified response header.</p>
<p>To use this condition, use the <code>lastModified</code> method after the <code>cacheControl</code> method. </p>
<pre><code class="language-php">$cache-&gt;cacheControl(&quot;public&quot;, 31536000);
$cache-&gt;lastModified();
</code></pre>
<p>The next time the browser requests this resource it will only ask for the contents of the resource if they’re unchanged since this date using the If-Modified-Since request header</p>
<pre><code class="language-php">$cache-&gt;ifModifiedSince();
</code></pre>
<p>If the resource hasn’t changed, the server will return with an empty body with the <code>304</code> response code.</p>
<h3 id="etag">Etag</h3>
<p>The ETag (or Entity Tag) works in a similar way to the Last-Modified header except its value is a digest of the resources contents (for instance, an MD5 hash). This allows the server to identify if the cached contents of the resource are different to the most recent version.</p>
<p>Use the <code>eTag</code> class parameter the value that will be cached.</p>
<pre><code class="language-php">$cache-&gt;cacheControl(&quot;public&quot;, 31536000);
$cache-&gt;eTag('value');
</code></pre>
<h3 id="cache-prevention">Cache prevention</h3>
<p>Highly secure or variable resources often require no caching. For instance, anything involving a shopping cart checkout process. Unfortunately, merely omitting cache headers will not work as many modern web browsers cache items based on their own internal algorithms. In such cases it is necessary to tell the browser to explicitly to not cache items.</p>
<p>In addition to public and private the Cache-Control header can specify no-cache and no-store which informs the browser to not cache the resources under any circumstances.</p>
<pre><code class="language-php">$cache-&gt;noCacheControl();
</code></pre>
<h2 id="clear-solital-cache">Clear Solital Cache</h2>
<p>When using your project several times, it is common for several stored session files to appear. These files are located inside the <code>app/Storage/session</code> folder. If you are using the Wolf cache, then these files can double in size.</p>
<p>If you need to, you can use the Vinci Console to clear the general cache, just the session cache, or just the Wolf cache.</p>
<p>To clear the general cache, use:</p>
<pre><code class="language-bash">php vinci cache:clear
</code></pre>
<p>If you only want to clear the session cache, use the <code>--session</code> option:</p>
<pre><code>php vinci cache:clear --session
</code></pre>
<p>And to clear the cache of the <code>app/Storage/cache/*</code> folder, use the <code>--cache</code> option:</p>
<pre><code>php vinci cache:clear --cache
</code></pre>
                

                <hr />

                
                <h3>What to see next?</h3>

                <section aria-label="breadcrumb" class="mt-4">
                  <ol class="breadcrumb">
                    
                      <li class="breadcrumb-item"><a href="../vinci-console/">&#8592; Vinci Console</a></li>
                    
                    
                      <li class="breadcrumb-item"><a href="../dependency-container/">Dependency Container &#8594;</a></li>
                    
                  </ol>
                </section>
                

              </div>

              <hr>

              <div class="row text-center mt-3">
                <div class="col-md-12 ml-2">
                  Built with <a href="https://www.mkdocs.org">MkDocs</a>.
                </div>
              </div>
            </div>

            <!--
              MkDocs version      : 1.5.3
              Docs Build Date UTC : 2023-11-10 11:10:40.043177+00:00
              -->

          </section>
        </div>
      </div>
    </div>
  </div>
</body>

</html>