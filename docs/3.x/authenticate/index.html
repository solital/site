<!DOCTYPE html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="robots" content="noindex, follow">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authenticate - Solital Framework</title>
  <link rel="shortcut icon" href="../img/favicon.ico">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@300&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/reset.css">
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <link rel="stylesheet" href="../css/sidebar.css">
  <link rel="stylesheet" href="../css/style.css">
  <link rel="stylesheet" href="../css/styles/default.css">
  <link rel="stylesheet" href="../css/styles/atom-one-dark.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />

  

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/bootstrap.bundle.min.js"></script>
  <script src="../js/highlight.pack.js"></script>
  <script src="../js/scripts.js"></script>
  <script>hljs.highlightAll();</script>

  
  

  
    <script src="../search/main.js"></script>
  

  

</head>

<body>
  <div class="dashboard">
    <div class="dashboard-nav">
      <header class="mb-4">
        <a href="#!" class="menu-toggle">
          <i class="fas fa-bars"></i>
        </a>

        <a href="https://solital.github.io/site/" class="brand-logo">
          <img src="../img/solital-logo-2-sm-trans-2.png" alt="Solital Framework">
        </a>
      </header>

      <nav class="dashboard-nav-list">
        
        
  <a href=".." class="dashboard-nav-item ">
    Starting
  </a>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Upgrade
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="https://github.com/solital/core/releases" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Release Notes
      </a>
    
      <a href="../upgrade-guide/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Upgrade Guide
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Settings
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../installation/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Installing
      </a>
    
      <a href="../environment-variables/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Environment Variables
      </a>
    
      <a href="../yaml-files/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> YAML Files
      </a>
    
      <a href="../helpers/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Helpers
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Routers
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../routes/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Routes
      </a>
    
      <a href="../middleware/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Middleware
      </a>
    
      <a href="../url/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> URL
      </a>
    
      <a href="../events/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Events
      </a>
    
      <a href="../input-and-params/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Input and params
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Components
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../vinci-console/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Vinci Console
      </a>
    
      <a href="../cache/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cache
      </a>
    
      <a href="../dependency-container/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dependency Container
      </a>
    
      <a href="../event-loop/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Event Loop
      </a>
    
      <a href="../http-client/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> HTTP Client
      </a>
    
      <a href="../wolf-template/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Wolf Template
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Resources
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../date-and-time/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Date and time
      </a>
    
      <a href="../file-system/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> File System
      </a>
    
      <a href="../json/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> JSON
      </a>
    
      <a href="../logger/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Logger
      </a>
    
      <a href="../mailer-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mailer
      </a>
    
      <a href="../session-and-cookie/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Session and Cookie
      </a>
    
      <a href="../validation-component/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Validation
      </a>
    
      <a href="../messages/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Messages
      </a>
    
      <a href="../queue/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Queue
      </a>
    
      <a href="../collection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Collection
      </a>
    
      <a href="../string-manipulate/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Strings
      </a>
    
      <a href="../mask/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Mask
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle active ">
    Security
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="./" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Authenticate
      </a>
    
      <a href="../cryptography/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Cryptography
      </a>
    
      <a href="../csrf-protection/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> CSRF Protection
      </a>
    
      <a href="../secure-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Secure Password
      </a>
    
      <a href="../verify-domain/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Verify Domain
      </a>
    
      <a href="../recovery-password/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Recovery Password
      </a>
    
  </div>
</div>

        
        
<div class="dashboard-nav-dropdown">
  <a href="#!" class="dashboard-nav-item dashboard-nav-dropdown-toggle ">
    Database
  </a>

  <div class="dashboard-nav-dropdown-menu">
    
      <a href="../migrations/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Migrations
      </a>
    
      <a href="../seeders/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Seeders
      </a>
    
      <a href="../dump/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Dump
      </a>
    
      <a href="../katrina-orm/" class="dashboard-nav-dropdown-item text-black">
        <span class="text-danger" style="margin-right: 10px;">&#10140;</span> Katrina ORM
      </a>
    
  </div>
</div>

        
        
  <a href="../deploy/" class="dashboard-nav-item ">
    Deploy
  </a>

        
      </nav>
    </div>

    <div class="dashboard-app">
      <header class="dashboard-toolbar">
        <a href="#!" class="menu-toggle btn-menu"><i class="fas fa-bars"></i></a>
      </header>

      <div class="dashboard-content">
        <div class="container">

          <section class="container section">
            <div class="row">
              <div class="col-md-12 col-sm-12 w-100">
                <div class="alert alert-warning" role="alert">
                  <div class="d-flex gap-4">
                    <span><i class="fa-solid fa-circle-exclamation icon-warning"></i></span>
                    <div class="d-flex flex-column gap-2">
                      <h4 class="mb-0 fw-semibold">You are reading documentation for an old version</h4>
                      <p class="mb-0 ">
                        <a href="https://solital.github.io/site/docs/">Click here to view the latest documentation</a>
                      </p>
                    </div>
                  </div>
                </div>

                <h1 class="mt-4 font-weight-normal title-page">Authenticate</h1>
              </div>

              <div class="col-md-12 col-sm-12 mt-3">
                

                <ul class="ml-5 mb-5">
                  
                    <li><a href="#defining-the-routes">Defining the routes</a></li>
                  
                  
                    <li><a href="#setting">Setting</a></li>
                  
                  
                    <li><a href="#changing-default-routes">Changing default routes</a></li>
                  
                  
                    <li><a href="#check-login">Check login</a></li>
                  
                  
                    <li><a href="#logoff">Logoff</a></li>
                  
                  
                    <li><a href="#standard-login-structure">Standard login structure</a></li>
                  
                  
                    <li><a href="#authentication-using-sodium-encryption">Authentication using Sodium encryption</a></li>
                  
                    <li><a href="#generating-a-sodium-key">Generating a sodium key</a></li>
                  
                    <li><a href="#encrypting-the-password">Encrypting the password</a></li>
                  
                    <li><a href="#verifying-the-password-with-sodium">Verifying the password with Sodium</a></li>
                  
                  
                </ul>

                
                <p>At first, you have the option to change the index where Solital will store the login in the <code>.env</code> file. </p>
<pre><code class="language-bash">INDEX_LOGIN='solital_index_login'
</code></pre>
<h2 id="defining-the-routes">Defining the routes</h2>
<p>You can define dashboard and login routes. The dashboard route will be for when the user authenticates, and the login route will be for when the user logs off and will be redirected to it.</p>
<p>To do this, open the <code>auth.yaml</code> file and edit the <code>auth_dashboard_url</code> and <code>auth_login_url</code> variables.</p>
<pre><code class="language-yaml">auth:
  auth_dashboard_url: /dashboard
  auth_login_url: /auth
</code></pre>
<h2 id="setting">Setting</h2>
<p>For this, it is necessary to first define the name of the table in the <code>login</code> method. In the <code>columns</code> method, the database username and password. Then, in the <code>values</code> method, the input values of the form. Finally, the <code>register</code> method will perform the login as shown below.</p>
<pre><code class="language-php">$res = Auth::login('auth_users')
            -&gt;columns('username', 'password')
            -&gt;values('inputEmail', 'inputPassword')
            -&gt;register();
</code></pre>
<p>The <code>$res</code> variable will return <code>true</code> if authentication is true. But if it is <code>false</code>, you can add a reply message after the above code if authentication fails.</p>
<pre><code class="language-php">if ($res == false) {
    message('login', 'Invalid username and/or password!');
    response()-&gt;redirect('your_login_url');
}
</code></pre>
<p>Below is an example method of authentication.</p>
<pre><code class="language-php">&lt;?php

namespace Solital\Components\Controller;

use Solital\Core\Http\Controller\Controller;
use Solital\Core\Auth\Auth;

class UserController extends Controller
{
    /**
     * @return void
     */
    public function authPost(): void
    {
        $res = Auth::login('auth_users')
            -&gt;columns('username', 'password')
            -&gt;values('inputEmail', 'inputPassword')
            -&gt;register();

        if ($res == false) {
            message('login', 'Invalid username and/or password!');
            response()-&gt;redirect(url('auth'));
        }
    }

}
</code></pre>
<h2 id="changing-default-routes">Changing default routes</h2>
<p>If you need more routes for dashboards and logins, you can change the parameter in the <code>register()</code> function:</p>
<pre><code class="language-php"># In routers.php

Course::get('/my-second-dashboard', 'SiteController@SecondDashboard')-&gt;name('second.dashboard');

# In Controller

$res = Auth::login('auth_users')
    -&gt;columns('username', 'password')
    -&gt;values('inputEmail', 'inputPassword')
    -&gt;register(url('second.dashboard'));

# Or

$res = Auth::login('auth_users')
    -&gt;columns('username', 'password')
    -&gt;values('inputEmail', 'inputPassword')
    -&gt;register('/my-second-dashboard');
</code></pre>
<h2 id="check-login">Check login</h2>
<p>To ensure that the user is authenticated, use the Auth::isNotLogged() method. If the login has not been validated, the user will be redirected to the route defined in the <code>auth.yaml</code> file or to the <code>/login</code> route.</p>
<pre><code class="language-php">/**
 * @return mixed
 */
public function dashboard(): mixed
{
    Auth::isNotLogged();

    return view('dashboard');
}
</code></pre>
<p>To ensure that the user doesn't fall into the login route when it has already been validated, insert the <code>Auth::isLogged()</code> method in your login route. This method will redirect the user to your system's dashboard.</p>
<pre><code class="language-php">/**
 * @return mixed
 */
public function auth(): mixed
{
    Auth::isLogged();

    return view('login');
}
</code></pre>
<h2 id="logoff">Logoff</h2>
<p>To logoff, use the <code>Auth::logoff()</code> method.</p>
<pre><code class="language-php">/**
 * @return void
 */
public function exit(): void
{
    Auth::logoff();
}
</code></pre>
<h2 id="standard-login-structure">Standard login structure</h2>
<p>To create a predefined login structure, use <code>php vinci auth:skeleton --login</code></p>
<p>This command will create a <code>LoginController</code> class, templates for authentication, dashboard and predefined routes. Plus a standard user in the database.</p>
<p>If you want to remove this structure, use <code>php vinci auth:skeleton --login --remove</code>.</p>
<h2 id="authentication-using-sodium-encryption">Authentication using Sodium encryption</h2>
<p>You can create an authentication using Sodium encryption.</p>
<h3 id="generating-a-sodium-key">Generating a sodium key</h3>
<p>First, you need to generate a sodium key. This key is automatically renewed with each new request, so it can be stored in a database, in the session or in another type of storage.</p>
<pre><code class="language-php">use Solital\Core\Security\Hash;

$key = Hash::getSodiumKey();
</code></pre>
<h3 id="encrypting-the-password">Encrypting the password</h3>
<p>Use <code>Auth::sodium()</code> to encrypt your password. Remember to use it in conjunction with the generated key.</p>
<pre><code class="language-php">use Solital\Core\Auth\Auth;
use Solital\Core\Security\Hash;

$key = Hash::getSodiumKey();
$encoded = Auth::sodium('password', $key);

pre($encoded);
</code></pre>
<h3 id="verifying-the-password-with-sodium">Verifying the password with Sodium</h3>
<p>To verify the password generated using the <code>Auth::sodium()</code> method, use <code>Auth::sodiumVerify()</code> together with the generated key, password and hash.</p>
<pre><code class="language-php">use Solital\Core\Auth\Auth;
use Solital\Core\Security\Hash;

$key = Hash::getSodiumKey();
$encoded = Auth::sodium('password', $key);
$decoded = Auth::sodiumVerify($encoded, 'password', $key);

pre($decoded);
</code></pre>
                

                <hr />

                
                <h3>What to see next?</h3>

                <section aria-label="breadcrumb" class="mt-4">
                  <ol class="breadcrumb">
                    
                      <li class="breadcrumb-item"><a href="../mask/">&#8592; Mask</a></li>
                    
                    
                      <li class="breadcrumb-item"><a href="../cryptography/">Cryptography &#8594;</a></li>
                    
                  </ol>
                </section>
                

              </div>

              <hr>

              <div class="row text-center mt-3">
                <div class="col-md-12 col-sm-12 ml-2">
                  Built with <a href="https://www.mkdocs.org">MkDocs</a>.
                </div>
              </div>
            </div>

            <!--
              MkDocs version      : 1.5.3
              Docs Build Date UTC : 2024-01-21 16:06:43.618698+00:00
              -->

          </section>
        </div>
      </div>
    </div>
  </div>
</body>

</html>